'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _pick2 = require('lodash/fp/pick');var _pick3 = _interopRequireDefault(_pick2);var _mapValues2 = require('lodash/fp/mapValues');var _mapValues3 = _interopRequireDefault(_mapValues2);var _compose2 = require('lodash/fp/compose');var _compose3 = _interopRequireDefault(_compose2);var _isNil2 = require('lodash/fp/isNil');var _isNil3 = _interopRequireDefault(_isNil2);var _negate3 = require('lodash/fp/negate');var _negate4 = _interopRequireDefault(_negate3);var _filter2 = require('lodash/fp/filter');var _filter3 = _interopRequireDefault(_filter2);var _partial2 = require('lodash/partial');var _partial3 = _interopRequireDefault(_partial2);var _defaults2 = require('lodash/defaults');var _defaults3 = _interopRequireDefault(_defaults2);var _keys2 = require('lodash/keys');var _keys3 = _interopRequireDefault(_keys2);var _constant2 = require('lodash/constant');var _constant3 = _interopRequireDefault(_constant2);var _isFunction2 = require('lodash/isFunction');var _isFunction3 = _interopRequireDefault(_isFunction2);var _isString2 = require('lodash/isString');var _isString3 = _interopRequireDefault(_isString2);var _negate5 = require('lodash/negate');var _negate6 = _interopRequireDefault(_negate5);var _noop2 = require('lodash/noop');var _noop3 = _interopRequireDefault(_noop2);var _identity2 = require('lodash/identity');var _identity3 = _interopRequireDefault(_identity2);var _extends = Object.assign || function (target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i];for (var key in source) {if (Object.prototype.hasOwnProperty.call(source, key)) {target[key] = source[key];}}}return target;};exports.
















































































































































chainableGenerator = chainableGenerator;exports.










chainableGeneratorWithDefaults = chainableGeneratorWithDefaults;function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _objectWithoutProperties(obj, keys) {var target = {};for (var i in obj) {if (keys.indexOf(i) >= 0) continue;if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;target[i] = obj[i];}return target;}function _toConsumableArray(arr) {if (Array.isArray(arr)) {for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {arr2[i] = arr[i];}return arr2;} else {return Array.from(arr);}} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * The default options for a new chain link.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * These will all be cast as functions so that users
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * can provide functional options if desired.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * @type {Object}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             */var defaultChainlinkOptions = { prefix: null, suffix: null, sanitize: _identity3.default, separator: '.', handleLinkInvocation: _noop3.default }; /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * The functional negation of _.isString
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @function
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  */var isNotString = (0, _negate6.default)(_isString3.default); /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Filters an array by removing all occurrences of `null` and `undefined`.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @function
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  */var removeNilValues = (0, _filter3.default)((0, _negate4.default)(_isNil3.default)); /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Converts non-function values to a function.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * @function
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          */var maybeCastFunction = function maybeCastFunction(thing) {return (0, _isFunction3.default)(thing) ? thing : (0, _constant3.default)(thing);}; /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Converts all chainlink options to functions.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @function
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            */var functionalizeChainlinkOptions = (0, _compose3.default)((0, _mapValues3.default)(maybeCastFunction), (0, _pick3.default)((0, _keys3.default)(defaultChainlinkOptions))); /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Gets the string representation of a chainlink.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * @returns {string} This chainlink's string value.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           */function chainlinkToString() {var prefix = this.prefix,suffix = this.suffix,sanitize = this.sanitize,separator = this.separator;var expanded = [prefix(this)].concat(_toConsumableArray(this.tokens.map(sanitize)), [suffix(this)]);return removeNilValues(expanded).join(separator(this));} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Creates a method that's called when the associated chainlink is invoked.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * @param {Object} properties The chainlink's property set.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * @returns {function} The chainlink's invocable base.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           */function handleChainlinkInvocation(properties) {return function chainlink() {this.handleLinkInvocation.call(this, _extends({}, properties));return this;};} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Creates a new chainlink.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * @param {Object} options Chainlink creation options.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * @returns {Object|function} The new chainlink.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          */function makeChainlink() {var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},_ref$tokens = _ref.tokens,tokens = _ref$tokens === undefined ? [] : _ref$tokens,_ref$functionalChainl = _ref.functionalChainlinks,functionalChainlinks = _ref$functionalChainl === undefined ? false : _ref$functionalChainl,options = _objectWithoutProperties(_ref, ['tokens', 'functionalChainlinks']);var chainlinkOptionsWithDefaults = (0, _defaults3.default)(options, defaultChainlinkOptions); // The set of properties the chainlink will contain.
  // The "base" of the chainlink can be either an object or function
  // if `functionalChainlinks` is true, chainlinks will be functions
  // and will be callable (left up the the user to implement).
  var properties = _extends({ property: null }, chainlinkOptionsWithDefaults, functionalizeChainlinkOptions(chainlinkOptionsWithDefaults), { tokens: tokens, toString: chainlinkToString, // Intentional: to prevent node from borking out when using a function
    // as a base and attempting to util.inspect or console.log the function.
    inspect: undefined });var base = functionalChainlinks ? handleChainlinkInvocation(properties) : {};return Object.assign(base, properties);} /**
                                                                                                                                                 * Creates a new Proxy object for the given chainlink.
                                                                                                                                                 * @param {Object|function} chainlink The chainlink to create the proxy for.
                                                                                                                                                 * @param {function} makeChildlink A function to create a childlink if the
                                                                                                                                                 * desired property doesn't exist on the current chainlink.
                                                                                                                                                 * @returns
                                                                                                                                                 * @export
                                                                                                                                                 */function proxifyChainlink(chainlink, makeChildlink) {return new Proxy(chainlink, { /**
                                                                                                                                                                                                                                       * A proxy trap that will return the requested property if it exists on
                                                                                                                                                                                                                                       * the target's prototype, or return a "child chainlink" if not. Here,
                                                                                                                                                                                                                                       * we don't care about non-string properties, since we can't handle
                                                                                                                                                                                                                                       * them anyways (the user using x.y.z will always produce a string).
                                                                                                                                                                                                                                       * @param {Object} target The chainable object which is being accessed.
                                                                                                                                                                                                                                       * @param {string|Symbol} key The name of the property being accessed.
                                                                                                                                                                                                                                       * @returns {any} The actual value of target[key] or a child chainlink.
                                                                                                                                                                                                                                       */get: function get(target, key) {if (key in target || isNotString(key)) return target[key];return makeChildlink(_extends({}, chainlink, { property: key, tokens: [].concat(_toConsumableArray(chainlink.tokens), [key]) }));} });} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Generates chainables and their proxy objects.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @param {Object} settings The settings used to create the chainable.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @param {function} childlinkGenerator The method used to create children of this link.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * This is used by `chainableGeneratorWithDefaults` to mixin default options.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @returns {Proxy} The chainable's proxy object.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @export
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            */function chainableGenerator() {var settings = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};var childlinkGenerator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : chainableGenerator;var options = (0, _isString3.default)(settings) ? { prefix: settings } : settings;return proxifyChainlink(makeChainlink(options), childlinkGenerator);} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Creates a function that will create chainable objects
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @param {Object} defaults The default options for this chainable object.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @returns {function} A function that will create new chainable objects, with
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * the supplied defaults mixed in with the options provided to the function.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            */function chainableGeneratorWithDefaults() {var defaults = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};var childlinkGenerator = chainableGeneratorWithDefaults(defaults);return function (settings) {return chainableGenerator((0, _defaults3.default)(settings, defaults), childlinkGenerator);};} // Creates the default chainable creation function
// that takes in options and returns a chainable proxy.
exports.default = (0, _partial3.default)(chainableGenerator, _partial3.default.placeholder, chainableGenerator);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jaGFpbmFibGUuanMiXSwibmFtZXMiOlsiY2hhaW5hYmxlR2VuZXJhdG9yIiwiY2hhaW5hYmxlR2VuZXJhdG9yV2l0aERlZmF1bHRzIiwiZGVmYXVsdENoYWlubGlua09wdGlvbnMiLCJwcmVmaXgiLCJzdWZmaXgiLCJzYW5pdGl6ZSIsInNlcGFyYXRvciIsImhhbmRsZUxpbmtJbnZvY2F0aW9uIiwiaXNOb3RTdHJpbmciLCJyZW1vdmVOaWxWYWx1ZXMiLCJtYXliZUNhc3RGdW5jdGlvbiIsInRoaW5nIiwiZnVuY3Rpb25hbGl6ZUNoYWlubGlua09wdGlvbnMiLCJjaGFpbmxpbmtUb1N0cmluZyIsImV4cGFuZGVkIiwidG9rZW5zIiwibWFwIiwiam9pbiIsImhhbmRsZUNoYWlubGlua0ludm9jYXRpb24iLCJwcm9wZXJ0aWVzIiwiY2hhaW5saW5rIiwiY2FsbCIsIm1ha2VDaGFpbmxpbmsiLCJmdW5jdGlvbmFsQ2hhaW5saW5rcyIsIm9wdGlvbnMiLCJjaGFpbmxpbmtPcHRpb25zV2l0aERlZmF1bHRzIiwicHJvcGVydHkiLCJ0b1N0cmluZyIsImluc3BlY3QiLCJ1bmRlZmluZWQiLCJiYXNlIiwiT2JqZWN0IiwiYXNzaWduIiwicHJveGlmeUNoYWlubGluayIsIm1ha2VDaGlsZGxpbmsiLCJQcm94eSIsImdldCIsInRhcmdldCIsImtleSIsInNldHRpbmdzIiwiY2hpbGRsaW5rR2VuZXJhdG9yIiwiZGVmYXVsdHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpSmdCQSxrQixHQUFBQSxrQjs7Ozs7Ozs7Ozs7QUFXQUMsOEIsR0FBQUEsOEIsNmVBekpoQjs7Ozs7K2lCQU1BLElBQU1DLDBCQUEwQixF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QU13QixVQUFVLHdCQUFXZSxRQUFYLElBQXVCLEVBQUVwQyxRQUFRb0MsUUFBVixFQUF2QixHQUE4Q0EsUUFBOUQsQ0FDQSxPQUFPTixpQkFBaUJYLGNBQWNFLE9BQWQsQ0FBakIsRUFBeUNnQixrQkFBekMsQ0FBUCxDQUNELEMsQ0FFRDs7Ozs7ODBCQU1PLFNBQVN2Qyw4QkFBVCxHQUF1RCxLQUFmd0MsUUFBZSx1RUFBSixFQUFJLENBQzVELElBQU1ELHFCQUFxQnZDLCtCQUErQndDLFFBQS9CLENBQTNCLENBQ0EsT0FBTyw0QkFBWXpDLG1CQUFtQix3QkFBV3VDLFFBQVgsRUFBcUJFLFFBQXJCLENBQW5CLEVBQW1ERCxrQkFBbkQsQ0FBWixFQUFQLENBQ0QsQyxDQUVEO0FBQ0E7a0JBQ2UsdUJBQVV4QyxrQkFBVixpQ0FBaUNBLGtCQUFqQyxDIiwiZmlsZSI6ImNoYWluYWJsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgZnAgZnJvbSAnbG9kYXNoL2ZwJztcblxuLyoqXG4gKiBUaGUgZGVmYXVsdCBvcHRpb25zIGZvciBhIG5ldyBjaGFpbiBsaW5rLlxuICogVGhlc2Ugd2lsbCBhbGwgYmUgY2FzdCBhcyBmdW5jdGlvbnMgc28gdGhhdCB1c2Vyc1xuICogY2FuIHByb3ZpZGUgZnVuY3Rpb25hbCBvcHRpb25zIGlmIGRlc2lyZWQuXG4gKiBAdHlwZSB7T2JqZWN0fVxuICovXG5jb25zdCBkZWZhdWx0Q2hhaW5saW5rT3B0aW9ucyA9IHtcbiAgcHJlZml4OiBudWxsLFxuICBzdWZmaXg6IG51bGwsXG4gIHNhbml0aXplOiBfLmlkZW50aXR5LFxuICBzZXBhcmF0b3I6ICcuJyxcbiAgaGFuZGxlTGlua0ludm9jYXRpb246IF8ubm9vcCxcbn07XG5cbi8qKlxuICogVGhlIGZ1bmN0aW9uYWwgbmVnYXRpb24gb2YgXy5pc1N0cmluZ1xuICogQGZ1bmN0aW9uXG4gKi9cbmNvbnN0IGlzTm90U3RyaW5nID0gXy5uZWdhdGUoXy5pc1N0cmluZyk7XG5cbi8qKlxuICogRmlsdGVycyBhbiBhcnJheSBieSByZW1vdmluZyBhbGwgb2NjdXJyZW5jZXMgb2YgYG51bGxgIGFuZCBgdW5kZWZpbmVkYC5cbiAqIEBmdW5jdGlvblxuICovXG5jb25zdCByZW1vdmVOaWxWYWx1ZXMgPSBmcC5maWx0ZXIoZnAubmVnYXRlKGZwLmlzTmlsKSk7XG5cbi8qKlxuICogQ29udmVydHMgbm9uLWZ1bmN0aW9uIHZhbHVlcyB0byBhIGZ1bmN0aW9uLlxuICogQGZ1bmN0aW9uXG4gKi9cbmNvbnN0IG1heWJlQ2FzdEZ1bmN0aW9uID0gdGhpbmcgPT4gKF8uaXNGdW5jdGlvbih0aGluZykgPyB0aGluZyA6IF8uY29uc3RhbnQodGhpbmcpKTtcblxuLyoqXG4gKiBDb252ZXJ0cyBhbGwgY2hhaW5saW5rIG9wdGlvbnMgdG8gZnVuY3Rpb25zLlxuICogQGZ1bmN0aW9uXG4gKi9cbmNvbnN0IGZ1bmN0aW9uYWxpemVDaGFpbmxpbmtPcHRpb25zID0gZnAuY29tcG9zZShcbiAgZnAubWFwVmFsdWVzKG1heWJlQ2FzdEZ1bmN0aW9uKSxcbiAgZnAucGljayhfLmtleXMoZGVmYXVsdENoYWlubGlua09wdGlvbnMpKSxcbik7XG5cbi8qKlxuICogR2V0cyB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGEgY2hhaW5saW5rLlxuICogQHJldHVybnMge3N0cmluZ30gVGhpcyBjaGFpbmxpbmsncyBzdHJpbmcgdmFsdWUuXG4gKi9cbmZ1bmN0aW9uIGNoYWlubGlua1RvU3RyaW5nKCkge1xuICBjb25zdCB7XG4gICAgcHJlZml4LFxuICAgIHN1ZmZpeCxcbiAgICBzYW5pdGl6ZSxcbiAgICBzZXBhcmF0b3IsXG4gIH0gPSB0aGlzO1xuXG4gIGNvbnN0IGV4cGFuZGVkID0gW3ByZWZpeCh0aGlzKSwgLi4udGhpcy50b2tlbnMubWFwKHNhbml0aXplKSwgc3VmZml4KHRoaXMpXTtcbiAgcmV0dXJuIHJlbW92ZU5pbFZhbHVlcyhleHBhbmRlZCkuam9pbihzZXBhcmF0b3IodGhpcykpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBtZXRob2QgdGhhdCdzIGNhbGxlZCB3aGVuIHRoZSBhc3NvY2lhdGVkIGNoYWlubGluayBpcyBpbnZva2VkLlxuICogQHBhcmFtIHtPYmplY3R9IHByb3BlcnRpZXMgVGhlIGNoYWlubGluaydzIHByb3BlcnR5IHNldC5cbiAqIEByZXR1cm5zIHtmdW5jdGlvbn0gVGhlIGNoYWlubGluaydzIGludm9jYWJsZSBiYXNlLlxuICovXG5mdW5jdGlvbiBoYW5kbGVDaGFpbmxpbmtJbnZvY2F0aW9uKHByb3BlcnRpZXMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGNoYWlubGluaygpIHtcbiAgICB0aGlzLmhhbmRsZUxpbmtJbnZvY2F0aW9uLmNhbGwodGhpcywgeyAuLi5wcm9wZXJ0aWVzIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgY2hhaW5saW5rLlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgQ2hhaW5saW5rIGNyZWF0aW9uIG9wdGlvbnMuXG4gKiBAcmV0dXJucyB7T2JqZWN0fGZ1bmN0aW9ufSBUaGUgbmV3IGNoYWlubGluay5cbiAqL1xuZnVuY3Rpb24gbWFrZUNoYWlubGluayh7XG4gIHRva2VucyA9IFtdLFxuICBmdW5jdGlvbmFsQ2hhaW5saW5rcyA9IGZhbHNlLFxuICAuLi5vcHRpb25zXG59ID0ge30pIHtcbiAgY29uc3QgY2hhaW5saW5rT3B0aW9uc1dpdGhEZWZhdWx0cyA9IF8uZGVmYXVsdHMob3B0aW9ucywgZGVmYXVsdENoYWlubGlua09wdGlvbnMpO1xuXG4gIC8vIFRoZSBzZXQgb2YgcHJvcGVydGllcyB0aGUgY2hhaW5saW5rIHdpbGwgY29udGFpbi5cbiAgLy8gVGhlIFwiYmFzZVwiIG9mIHRoZSBjaGFpbmxpbmsgY2FuIGJlIGVpdGhlciBhbiBvYmplY3Qgb3IgZnVuY3Rpb25cbiAgLy8gaWYgYGZ1bmN0aW9uYWxDaGFpbmxpbmtzYCBpcyB0cnVlLCBjaGFpbmxpbmtzIHdpbGwgYmUgZnVuY3Rpb25zXG4gIC8vIGFuZCB3aWxsIGJlIGNhbGxhYmxlIChsZWZ0IHVwIHRoZSB0aGUgdXNlciB0byBpbXBsZW1lbnQpLlxuICBjb25zdCBwcm9wZXJ0aWVzID0ge1xuICAgIHByb3BlcnR5OiBudWxsLFxuXG4gICAgLi4uY2hhaW5saW5rT3B0aW9uc1dpdGhEZWZhdWx0cyxcbiAgICAuLi5mdW5jdGlvbmFsaXplQ2hhaW5saW5rT3B0aW9ucyhjaGFpbmxpbmtPcHRpb25zV2l0aERlZmF1bHRzKSxcblxuICAgIHRva2VucyxcbiAgICB0b1N0cmluZzogY2hhaW5saW5rVG9TdHJpbmcsXG5cbiAgICAvLyBJbnRlbnRpb25hbDogdG8gcHJldmVudCBub2RlIGZyb20gYm9ya2luZyBvdXQgd2hlbiB1c2luZyBhIGZ1bmN0aW9uXG4gICAgLy8gYXMgYSBiYXNlIGFuZCBhdHRlbXB0aW5nIHRvIHV0aWwuaW5zcGVjdCBvciBjb25zb2xlLmxvZyB0aGUgZnVuY3Rpb24uXG4gICAgaW5zcGVjdDogdW5kZWZpbmVkLFxuICB9O1xuXG4gIGNvbnN0IGJhc2UgPSBmdW5jdGlvbmFsQ2hhaW5saW5rcyA/IGhhbmRsZUNoYWlubGlua0ludm9jYXRpb24ocHJvcGVydGllcykgOiB7fTtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oYmFzZSwgcHJvcGVydGllcyk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBQcm94eSBvYmplY3QgZm9yIHRoZSBnaXZlbiBjaGFpbmxpbmsuXG4gKiBAcGFyYW0ge09iamVjdHxmdW5jdGlvbn0gY2hhaW5saW5rIFRoZSBjaGFpbmxpbmsgdG8gY3JlYXRlIHRoZSBwcm94eSBmb3IuXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBtYWtlQ2hpbGRsaW5rIEEgZnVuY3Rpb24gdG8gY3JlYXRlIGEgY2hpbGRsaW5rIGlmIHRoZVxuICogZGVzaXJlZCBwcm9wZXJ0eSBkb2Vzbid0IGV4aXN0IG9uIHRoZSBjdXJyZW50IGNoYWlubGluay5cbiAqIEByZXR1cm5zXG4gKiBAZXhwb3J0XG4gKi9cbmZ1bmN0aW9uIHByb3hpZnlDaGFpbmxpbmsoY2hhaW5saW5rLCBtYWtlQ2hpbGRsaW5rKSB7XG4gIHJldHVybiBuZXcgUHJveHkoY2hhaW5saW5rLCB7XG4gICAgLyoqXG4gICAgICogQSBwcm94eSB0cmFwIHRoYXQgd2lsbCByZXR1cm4gdGhlIHJlcXVlc3RlZCBwcm9wZXJ0eSBpZiBpdCBleGlzdHMgb25cbiAgICAgKiB0aGUgdGFyZ2V0J3MgcHJvdG90eXBlLCBvciByZXR1cm4gYSBcImNoaWxkIGNoYWlubGlua1wiIGlmIG5vdC4gSGVyZSxcbiAgICAgKiB3ZSBkb24ndCBjYXJlIGFib3V0IG5vbi1zdHJpbmcgcHJvcGVydGllcywgc2luY2Ugd2UgY2FuJ3QgaGFuZGxlXG4gICAgICogdGhlbSBhbnl3YXlzICh0aGUgdXNlciB1c2luZyB4LnkueiB3aWxsIGFsd2F5cyBwcm9kdWNlIGEgc3RyaW5nKS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSBjaGFpbmFibGUgb2JqZWN0IHdoaWNoIGlzIGJlaW5nIGFjY2Vzc2VkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfFN5bWJvbH0ga2V5IFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSBiZWluZyBhY2Nlc3NlZC5cbiAgICAgKiBAcmV0dXJucyB7YW55fSBUaGUgYWN0dWFsIHZhbHVlIG9mIHRhcmdldFtrZXldIG9yIGEgY2hpbGQgY2hhaW5saW5rLlxuICAgICAqL1xuICAgIGdldCh0YXJnZXQsIGtleSkge1xuICAgICAgaWYgKGtleSBpbiB0YXJnZXQgfHwgaXNOb3RTdHJpbmcoa2V5KSkgcmV0dXJuIHRhcmdldFtrZXldO1xuXG4gICAgICByZXR1cm4gbWFrZUNoaWxkbGluayh7XG4gICAgICAgIC4uLmNoYWlubGluayxcbiAgICAgICAgcHJvcGVydHk6IGtleSxcbiAgICAgICAgdG9rZW5zOiBbLi4uY2hhaW5saW5rLnRva2Vucywga2V5XSxcbiAgICAgIH0pO1xuICAgIH0sXG4gIH0pO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBjaGFpbmFibGVzIGFuZCB0aGVpciBwcm94eSBvYmplY3RzLlxuICogQHBhcmFtIHtPYmplY3R9IHNldHRpbmdzIFRoZSBzZXR0aW5ncyB1c2VkIHRvIGNyZWF0ZSB0aGUgY2hhaW5hYmxlLlxuICogQHBhcmFtIHtmdW5jdGlvbn0gY2hpbGRsaW5rR2VuZXJhdG9yIFRoZSBtZXRob2QgdXNlZCB0byBjcmVhdGUgY2hpbGRyZW4gb2YgdGhpcyBsaW5rLlxuICogVGhpcyBpcyB1c2VkIGJ5IGBjaGFpbmFibGVHZW5lcmF0b3JXaXRoRGVmYXVsdHNgIHRvIG1peGluIGRlZmF1bHQgb3B0aW9ucy5cbiAqIEByZXR1cm5zIHtQcm94eX0gVGhlIGNoYWluYWJsZSdzIHByb3h5IG9iamVjdC5cbiAqIEBleHBvcnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoYWluYWJsZUdlbmVyYXRvcihzZXR0aW5ncyA9IHt9LCBjaGlsZGxpbmtHZW5lcmF0b3IgPSBjaGFpbmFibGVHZW5lcmF0b3IpIHtcbiAgY29uc3Qgb3B0aW9ucyA9IF8uaXNTdHJpbmcoc2V0dGluZ3MpID8geyBwcmVmaXg6IHNldHRpbmdzIH0gOiBzZXR0aW5ncztcbiAgcmV0dXJuIHByb3hpZnlDaGFpbmxpbmsobWFrZUNoYWlubGluayhvcHRpb25zKSwgY2hpbGRsaW5rR2VuZXJhdG9yKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCB3aWxsIGNyZWF0ZSBjaGFpbmFibGUgb2JqZWN0c1xuICogQHBhcmFtIHtPYmplY3R9IGRlZmF1bHRzIFRoZSBkZWZhdWx0IG9wdGlvbnMgZm9yIHRoaXMgY2hhaW5hYmxlIG9iamVjdC5cbiAqIEByZXR1cm5zIHtmdW5jdGlvbn0gQSBmdW5jdGlvbiB0aGF0IHdpbGwgY3JlYXRlIG5ldyBjaGFpbmFibGUgb2JqZWN0cywgd2l0aFxuICogdGhlIHN1cHBsaWVkIGRlZmF1bHRzIG1peGVkIGluIHdpdGggdGhlIG9wdGlvbnMgcHJvdmlkZWQgdG8gdGhlIGZ1bmN0aW9uLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hhaW5hYmxlR2VuZXJhdG9yV2l0aERlZmF1bHRzKGRlZmF1bHRzID0ge30pIHtcbiAgY29uc3QgY2hpbGRsaW5rR2VuZXJhdG9yID0gY2hhaW5hYmxlR2VuZXJhdG9yV2l0aERlZmF1bHRzKGRlZmF1bHRzKTtcbiAgcmV0dXJuIHNldHRpbmdzID0+IGNoYWluYWJsZUdlbmVyYXRvcihfLmRlZmF1bHRzKHNldHRpbmdzLCBkZWZhdWx0cyksIGNoaWxkbGlua0dlbmVyYXRvcik7XG59XG5cbi8vIENyZWF0ZXMgdGhlIGRlZmF1bHQgY2hhaW5hYmxlIGNyZWF0aW9uIGZ1bmN0aW9uXG4vLyB0aGF0IHRha2VzIGluIG9wdGlvbnMgYW5kIHJldHVybnMgYSBjaGFpbmFibGUgcHJveHkuXG5leHBvcnQgZGVmYXVsdCBfLnBhcnRpYWwoY2hhaW5hYmxlR2VuZXJhdG9yLCBfLCBjaGFpbmFibGVHZW5lcmF0b3IpO1xuIl19
